import yara

def detect_malware(file_path):
    rules = yara.compile("rules.yar")
    matches = rules.match(file_path)

    if matches:
        print("Malware detected!")
        for match in matches:
            print(match.rule)
    else:
        print("No malware detected.")

if __name__ == "__main__":
    file_path = "sample.exe"
    detect_malware(file_path)
    
'''
This code first imports the yara library. Then, it defines a function called detect_malware() that takes a file path as input. 
The function uses the yara library to compile a set of YARA rules from a file called rules.yar. 
Then, it uses the match() method to scan the file path for matches to the YARA rules. 
If any matches are found, the function prints a message indicating that malware has been detected. 
Otherwise, the function prints a message indicating that no malware was detected.

To run this code, you will need to have the yara library installed. You can install the yara library using the following command:

pip install yara
Once you have installed the yara library, you can run the code by saving it as a Python script and then running the script from the command line. 
For example, if you save the code as malware_detection.py, you can run the script by typing the following command into the command line:

python malware_detection.py
This will scan the file sample.exe for malware signatures. 
If any malware signatures are found, the script will print a message indicating that malware has been detected. 
Otherwise, the script will print a message indicating that no malware was detected.
'''


